// Generated by CoffeeScript 1.6.3
(function() {
  var Earth, failureCB, initCB, run_slide_show, setUpEarth;

  setUpEarth = function() {
    return google.earth.createInstance('map3d', initCB, failureCB);
  };

  initCB = function(instance) {
    window.google_earth = instance;
    return window.google_earth.getWindow().setVisibility(true);
  };

  failureCB = function(errorCode) {
    return console.log(errorCode);
  };

  Earth = (function() {
    function Earth() {}

    Earth.prototype.setViewTo = function(location) {
      console.log("Hey we're at " + location.name);
      if (location.lat) {
        return console.log(location.lat);
      }
    };

    return Earth;

  })();

  google.setOnLoadCallback(setUpEarth);

  run_slide_show = function() {
    var $scope, earth, pan_through_schools, pan_through_states, schools_in_states;
    earth = new Earth;
    $scope = {};
    pan_through_schools = function(schools) {
      var callback, iterator, length, timer;
      console.log("IMMA LOOP THROUGH DEM SCHOOLS " + schools);
      iterator = 0;
      length = schools.length;
      callback = function() {
        if (iterator === length - 1) {
          clearInterval(timer);
        }
        iterator++;
      };
      return timer = setInterval(callback, 1000);
    };
    pan_through_states = function(states) {
      var callback, iterator, length, timer;
      console.log("IMMA LOOP THROUGH DEM STATES " + states);
      iterator = 0;
      length = states.length;
      callback = function() {
        var state;
        state = states[iterator];
        earth.setViewTo(state);
        $scope.title = state;
        $scope.highlighted = null;
        pan_through_schools(state.schools);
        if (iterator === length - 1) {
          clearInterval(timer);
        }
        iterator++;
      };
      return timer = setInterval(callback, 10000);
    };
    schools_in_states = [
      {
        name: "Victoria",
        schools: [
          {
            name: "Camberwell Grammar",
            logo: "http://catholicschoolsguide.com.au/wp-content/uploads/xavier-college1.jpg",
            lat: "-37.8169075",
            lng: "145.0682967"
          }, {
            name: "Xavier College",
            logo: "http://catholicschoolsguide.com.au/wp-content/uploads/xavier-college1.jpg",
            lat: "-37.812269",
            lng: "145.031685"
          }
        ]
      }, {
        name: "Western Australia",
        schools: [
          {
            name: "Mazenod College",
            logo: "http://catholicschoolsguide.com.au/wp-content/uploads/xavier-college1.jpg"
          }, {
            name: "Perth College",
            logo: "http://catholicschoolsguide.com.au/wp-content/uploads/xavier-college1.jpg"
          }
        ]
      }
    ];
    pan_through_states(schools_in_states);
    return setTimeout(run_slide_show, 1000 * 30);
  };

  run_slide_show();

}).call(this);
